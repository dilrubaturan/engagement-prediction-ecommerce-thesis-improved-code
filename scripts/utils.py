# -*- coding: utf-8 -*-
"""utils.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/106q9T4J9BmzEqFoVo59H428VYar_drIt
"""

from pathlib import Path
import numpy as np, pandas as pd, json, random, os, warnings
from sklearn.metrics import f1_score, classification_report, confusion_matrix

SEED = 42
os.environ["PYTHONHASHSEED"] = str(SEED)
np.random.seed(SEED)
random.seed(SEED)
warnings.filterwarnings("ignore")

def to_numeric(df: pd.DataFrame) -> pd.DataFrame:
    df = df.apply(pd.to_numeric, errors="coerce").fillna(0)
    return df

def mode(series):
    return series.mode().iloc[0] if not series.mode().empty else np.nan

def eval_report(y_true, y_pred) -> dict:
    return {
        "macro_f1": f1_score(y_true, y_pred, average="macro"),
        "classification_report": classification_report(y_true, y_pred, digits=4, output_dict=True),
        "confusion_matrix": confusion_matrix(y_true, y_pred).tolist(),
    }

def save_json(obj, path: Path):
    path.write_text(json.dumps(obj, indent=2))